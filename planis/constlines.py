"""
Constellation Lines by Hipparcos catalogue
"""

lines="""\
And,677,3092
And,3092,5447
And,9640,5447
And,5447,4436
And,4436,3881
Ant,51172,48926
Aps,72370,81065
Aps,81065,81852
Aql,98036,97649
Aql,97649,97278
Aql,97649,95501
Aql,95501,97804
Aql,99473,97804
Aql,95501,93747
Aql,93747,93244
Aql,95501,93805
Aqr,106278,109074
Aqr,109074,110395
Aqr,110395,110960
Aqr,110960,111497
Aqr,111497,112961
Aqr,112961,114855
Aqr,114855,115438
Aqr,109074,110003
Aqr,110003,109139
Aqr,110003,111123
Aqr,111123,112716
Aqr,112716,113136
Aqr,113136,114341
Aqr,102618,106278
Ara,88714,85792
Ara,85792,83081
Ara,83081,82363
Ara,82363,85727
Ara,85727,85267
Ara,85267,85258
Ara,85258,88714
Ari,13209,9884
Ari,9884,8903
Ari,8903,8832
Aur,28380,28360
Aur,28360,24608
Aur,24608,23453
Aur,23453,23015
Aur,25428,23015
Aur,25428,28380
Boo,71795,69673
Boo,69673,72105
Boo,72105,74666
Boo,74666,73555
Boo,73555,71075
Boo,71075,71053
Boo,71053,69673
Boo,69673,67927
Boo,67927,67459
Cae,21060,21770
Cae,21770,21861
Cam,16228,18505
Cam,18505,22783
Cam,16228,17959
Cam,17959,22783
Cam,17959,25110
Cap,100064,100345
Cap,100345,104139
Cap,104139,105515
Cap,105515,106985
Cap,106985,107556
Cap,105515,105881
Cap,105881,104139
Cap,100345,102485
Cap,104139,102978
Car,45238,50099
Car,50099,52419
Car,52419,52468
Car,52468,54463
Car,54463,53253
Car,53253,51232
Car,51232,50371
Car,50371,45556
Car,42568,41037
Car,41037,30438
Car,45080,45556
Car,45080,42568
Car,30438,31685
Car,41037,39429
Cas,8886,6686
Cas,6686,4427
Cas,4427,3179
Cas,3179,746
Cen,71683,68702
Cen,68702,66657
Cen,66657,68002
Cen,68002,68282
Cen,68282,67472
Cen,67472,67464
Cen,67464,65936
Cen,65936,65109
Cen,67464,68933
Cen,67472,71352
Cen,71352,73334
Cen,68002,61932
Cen,61932,60823
Cen,60823,59196
Cen,59196,56480
Cen,56480,56561
Cep,109492,112724
Cep,112724,106032
Cep,106032,105199
Cep,105199,109492
Cep,112724,116727
Cep,116727,106032
Cet,10324,11484
Cet,8102,3419
Cet,3419,1562
Cet,3419,5364
Cet,5364,6537
Cet,6537,8645
Cet,8645,11345
Cet,11345,12390
Cet,12390,12770
Cet,12770,11783
Cet,11783,8102
Cet,10826,12390
Cet,10826,12387
Cet,12387,12706
Cet,12706,14135
Cet,14135,13954
Cet,13954,12828
Cet,12828,11484
Cet,11484,12093
Cet,12093,12706
Cha,40702,51839
Cha,51839,60000
Cir,71908,75323
Cir,71908,74824
CMa,33160,34045
CMa,34045,33347
CMa,33347,32349
CMa,32349,33977
CMa,33977,34444
CMa,34444,35037
CMa,35037,35904
CMa,33579,33856
CMa,33856,34444
CMa,33856,33165
CMa,33165,31592
CMa,31592,31416
CMa,31592,30324
CMa,31592,32349
CMa,33579,32759
CMa,30122,33579
CMa,33347,33160
CMi,37279,36188
Cnc,43103,42806
Cnc,42806,40843
Cnc,42806,42911
Cnc,42911,40526
Cnc,42911,44066
Col,30277,29807
Col,29807,28199
Col,28199,27628
Col,27628,28328
Col,27628,26634
Col,26634,25859
Com,64241,64394
Com,64394,60742
CrA,91875,92989
CrA,92989,93174
CrA,93174,93825
CrA,93825,94114
CrA,94114,94160
CrA,94160,94005
CrA,94005,93542
CrA,93542,92953
CrA,91875,90887
CrB,76127,75695
CrB,75695,76267
CrB,76267,76952
CrB,76952,77512
CrB,77512,78159
CrB,78159,78493
Crt,53740,54682
Crt,54682,55705
Crt,55705,55282
Crt,55282,53740
Crt,55282,55687
Crt,55687,56633
Crt,56633,58188
Crt,58188,57283
Crt,57283,55705
Cru,61084,60718
Cru,62434,59747
Crv,61174,60965
Crv,60965,59803
Crv,59803,59316
Crv,59316,59199
Crv,59316,61359
Crv,61359,60965
CVn,61317,63125
Cyg,94779,95853
Cyg,95853,97165
Cyg,97165,100453
Cyg,100453,102098
Cyg,100453,102488
Cyg,102488,104732
Cyg,104732,107310
Cyg,100453,98110
Cyg,98110,95947
Del,101421,101769
Del,101769,101958
Del,101958,102532
Del,102532,102281
Del,102281,101769
Dor,27100,27890
Dor,27890,26069
Dor,26069,27100
Dor,26069,21281
Dor,21281,19893
Dra,87585,87833
Dra,87833,85670
Dra,85670,85829
Dra,85829,87585
Dra,87585,94376
Dra,94376,97433
Dra,97433,89937
Dra,89937,83895
Dra,83895,80331
Dra,80331,78527
Dra,78527,75458
Dra,75458,68756
Dra,68756,61281
Dra,61281,56211
Equ,104521,104858
Equ,104858,105570
Equ,105570,104987
Equ,104987,104521
Eri,7588,9007
Eri,9007,10602
Eri,10602,11407
Eri,11407,12413
Eri,12413,12486
Eri,12486,13847
Eri,13847,15510
Eri,15510,17797
Eri,17797,17874
Eri,17874,20042
Eri,20042,20535
Eri,20535,21393
Eri,21393,17651
Eri,17651,16611
Eri,16611,15474
Eri,15474,14146
Eri,14146,12843
Eri,12843,13701
Eri,13701,15197
Eri,15197,16537
Eri,16537,17378
Eri,17378,21444
Eri,21444,22109
Eri,22109,22701
Eri,22701,23875
Eri,23875,23972
Eri,23972,21594
For,13147,14879
Gem,31681,34088
Gem,34088,35550
Gem,35550,35350
Gem,35350,32362
Gem,35550,36962
Gem,36962,37740
Gem,36962,37826
Gem,36962,36046
Gem,36046,34693
Gem,34693,36850
Gem,34693,33018
Gem,34693,32246
Gem,32246,30883
Gem,32246,30343
Gem,30343,29655
Gem,29655,28734
Gru,114131,110997
Gru,110997,109268
Gru,109268,112122
Gru,112122,114421
Gru,114421,114131
Gru,112122,113638
Gru,112122,112623
Gru,109268,109111
Gru,109111,108085
Her,86414,87808
Her,87808,85112
Her,85112,84606
Her,84606,84380
Her,84380,81833
Her,81833,81126
Her,81126,79992
Her,79992,77760
Her,81833,81693
Her,81693,80816
Her,80816,80170
Her,81693,83207
Her,83207,85693
Her,85693,84379
Her,86974,87933
Her,87933,88794
Her,87933,86974
Her,83207,84380
Hor,19747,12484
Hor,12484,14240
Hya,42799,42402
Hya,42402,42313
Hya,42313,43109
Hya,43109,43234
Hya,43234,42799
Hya,43234,43813
Hya,43813,45336
Hya,45336,46776
Hya,46776,46509
Hya,46509,46390
Hya,46390,48356
Hya,48356,49841
Hya,49841,51069
Hya,51069,52943
Hya,52943,56343
Hya,56343,57936
Hya,57936,64166
Hya,64166,64962
Hyi,2021,17678
Hyi,17678,12394
Hyi,12394,11001
Hyi,11001,9236
Ind,105319,101772
Ind,101772,103227
Ind,103227,105319
Lac,109937,111104
Lac,111104,111022
Lac,111022,110609
Lac,110609,110538
Lac,110538,111169
Lac,111169,111022
Leo,57632,54879
Leo,54879,49669
Leo,49669,49583
Leo,49583,50583
Leo,50583,54872
Leo,54872,57632
Leo,50583,50335
Leo,50335,48455
Leo,48455,47908
Leo,54872,54879
Lep,28910,28103
Lep,28103,27288
Lep,27288,25985
Lep,25985,24305
Lep,25985,27654
Lep,27654,27072
Lep,27072,25606
Lep,25606,23685
Lep,25985,25606
Lep,24305,24845
Lep,24305,24327
Lep,23685,24305
Lep,24327,24244
Lep,24845,24873
Lib,77853,76333
Lib,76333,74785
Lib,74785,72622
Lib,72622,73714
Lib,73714,76333
LMi,53229,51233
LMi,51233,49593
LMi,49593,46952
LMi,49593,53229
Lup,77634,78970
Lup,78970,78384
Lup,78384,77634
Lup,78384,76297
Lup,76297,75141
Lup,75141,75177
Lup,75141,73273
Lup,76297,76552
Lup,76552,74395
Lup,74395,71860
Lup,74395,71536
Lup,71860,70576
Lup,71860,73273
Lyn,45860,45688
Lyn,45688,44700
Lyn,44700,44248
Lyn,44248,41075
Lyn,41075,36145
Lyn,36145,33449
Lyn,33449,30060
Lyr,91262,91971
Lyr,91971,92420
Lyr,92420,93194
Lyr,93194,92791
Lyr,92791,91971
Men,25918,21949
Mic,105140,103738
Mic,103738,102831
Mon,29651,30867
Mon,30867,34769
Mon,34769,30419
Mon,30419,29151
Mon,34769,39863
Mon,39863,37447
Mus,62322,57363
Mus,57363,61199
Mus,61199,61585
Mus,61585,62322
Nor,79509,80000
Nor,80000,80582
Nor,80582,78639
Nor,78639,80000
Nor,78639,79509
Oct,107089,112405
Oct,112405,70638
Oct,70638,107089
Oph,86032,86742
Oph,84012,86742
Oph,86032,83000
Oph,83000,79882
Oph,79882,81377
Oph,81377,84012
Oph,84012,85755
Ori,26727,26311
Ori,26311,25930
Ori,28691,29426
Ori,29426,29038
Ori,29038,27913
Ori,29426,28614
Ori,28614,27989
Ori,27989,26727
Ori,26727,27366
Ori,27366,24436
Ori,24436,25930
Ori,25930,25336
Ori,25336,26207
Ori,26207,27989
Ori,25336,22449
Ori,22449,22549
Ori,22549,22730
Ori,22730,23123
Ori,22449,22509
Ori,22509,22845
Ori,29038,28614
Pav,100751,105858
Pav,105858,102395
Pav,102395,99240
Pav,99240,100751
Pav,99240,98495
Pav,98495,91792
Pav,91792,93015
Pav,93015,99240
Pav,93015,92609
Pav,92609,90098
Pav,90098,88866
Pav,88866,92609
Pav,88866,86929
Peg,1067,113963
Peg,113881,112158
Peg,112158,109352
Peg,113881,112748
Peg,112748,112440
Peg,112440,109176
Peg,109176,107354
Peg,113963,112447
Peg,112447,112029
Peg,112029,109427
Peg,109427,107315
Peg,677,113881
Peg,677,1067
Peg,113881,113963
Per,17448,18246
Per,18246,18614
Per,18614,18532
Per,18532,17358
Per,17358,15863
Per,15863,14328
Per,14328,13268
Per,15863,14576
Per,14576,14354
Per,14354,13254
Phe,5348,5165
Phe,5165,2072
Phe,2072,5348
Phe,5165,7083
Phe,7083,8837
Phe,8837,5165
Phe,5165,6867
Phe,6867,2072
Phe,2072,2081
Phe,2081,765
Phe,765,2072
Pic,32607,27530
Pic,27530,27321
PsA,113368,111954
PsA,111954,108661
PsA,108661,107608
PsA,107608,109422
PsA,109422,111188
PsA,111188,113246
Psc,4889,5742
Psc,4889,6193
Psc,6193,5742
Psc,5742,7097
Psc,7097,8198
Psc,8198,9487
Psc,9487,8833
Psc,8833,7884
Psc,7884,7007
Psc,7007,4906
Psc,4906,3760
Psc,3760,1645
Psc,1645,118268
Psc,118268,116771
Psc,116771,116928
Psc,116928,115738
Psc,115738,114971
Psc,114971,115830
Psc,115830,116771
Pup,39757,38146
Pup,38146,35264
Pup,35264,31685
Pup,31685,32768
Pup,32768,36377
Pup,36377,39429
Pup,39429,39757
Pyx,42515,42828
Pyx,42828,43409
Ret,19780,19921
Ret,19921,18597
Ret,18597,17440
Ret,17440,19780
Scl,116231,4577
Scl,4577,115102
Scl,115102,116231
Sco,85927,86670
Sco,86670,87073
Sco,87073,86228
Sco,86228,84143
Sco,84143,82671
Sco,82671,82514
Sco,82514,82396
Sco,82396,81266
Sco,81266,80763
Sco,80763,78401
Sco,80763,78265
Sco,80763,78820
Sct,92175,92202
Sct,92202,92814
Sct,92814,90595
Sct,90595,91117
Sct,91117,92175
Ser,77516,77622
Ser,77622,77070
Ser,77070,76276
Ser,76276,77233
Ser,77233,78072
Ser,78072,77450
Ser,77450,77233
Ser,92946,89962
Ser,89962,86565
Ser,86565,86263
Ser,86263,84880
Sex,51437,49641
Sge,96837,97365
Sge,97365,96757
Sge,97365,98337
Sge,98337,98920
Sgr,89931,90496
Sgr,89642,90185
Sgr,90185,88635
Sgr,88635,87072
Sgr,88635,89931
Sgr,89931,90185
Sgr,90185,93506
Sgr,93506,92041
Sgr,92041,89931
Sgr,92041,90496
Sgr,90496,89341
Sgr,93506,93864
Sgr,93864,92855
Sgr,92855,92041
Sgr,92855,93085
Sgr,93085,93683
Sgr,93683,94820
Sgr,94820,95168
Sgr,93864,96406
Sgr,96406,98688
Sgr,98688,98412
Sgr,98412,98032
Sgr,98032,95347
Sgr,98032,95294
Tau,25428,21881
Tau,21881,20889
Tau,21421,26451
Tau,20205,20455
Tau,20205,18724
Tau,18724,15900
Tau,21421,20889
Tau,21421,20894
Tau,20894,20205
Tau,20889,20648
Tau,20648,20455
Tau,20455,17847
Tel,90568,90422
TrA,82273,74946
TrA,74946,77952
TrA,77952,82273
Tri,10559,10064
Tri,10064,8796
Tri,8796,10559
Tuc,110130,114996
Tuc,114996,1599
Tuc,114996,2484
UMa,67301,65378
UMa,65378,62956
UMa,62956,59774
UMa,59774,54061
UMa,54061,53910
UMa,53910,58001
UMa,58001,59774
UMa,58001,57399
UMa,57399,54539
UMa,54539,50372
UMa,54539,50801
UMa,53910,48402
UMa,48402,46853
UMa,46853,44471
UMa,46853,44127
UMa,48402,48319
UMa,48319,41704
UMa,41704,46733
UMa,46733,54061
UMi,11767,85822
UMi,85822,82080
UMi,82080,77055
UMi,77055,79822
UMi,79822,75097
UMi,75097,72607
UMi,72607,77055
Vel,39953,42536
Vel,42536,42913
Vel,42913,45941
Vel,45941,48774
Vel,48774,52727
Vel,52727,51986
Vel,51986,50191
Vel,50191,46651
Vel,46651,44816
Vel,44816,39953
Vir,57380,60030
Vir,60030,61941
Vir,61941,65474
Vir,65474,69427
Vir,69427,69701
Vir,69701,71957
Vir,65474,66249
Vir,66249,68520
Vir,68520,72220
Vir,66249,63090
Vir,63090,63608
Vir,63090,61941
Vol,37504,34481
Vol,34481,39794
Vol,39794,37504
Vol,39794,35228
Vol,39794,41312
Vol,41312,44382
Vol,44382,39794
Vul,95771,98543
"""

import math
import numpy as np
import matplotlib.pyplot as plt
import ephem
import stars as hip
import planisfunc as plf
import constJ as cj

class const_line:
    def __init__(self, observe, ax, zo, legend):
        
        Name1 = []
        Name2 = []
        for line in lines.split('\n'):
            try:
                name1 = line.split(',')[1]
                name2 = line.split(',')[2]
                starz1 = hip.star(name1)
                starz2 = hip.star(name2)
                Name1.append(starz1)
                Name2.append(starz2)

            except:
                None

        for i in range(len(Name1)):
            Name1[i].compute(observe)

        for i in range(len(Name2)):
            Name2[i].compute(observe)

        AZ1  = np.array([float(body.az) for body in Name1])
        ALT1 = np.array([float(body.alt) for body in Name1])
        AZ2  = np.array([float(body.az) for body in Name2])
        ALT2 = np.array([float(body.alt) for body in Name2])

        lim = np.pi /36.
    
        AZ3  = AZ1[np.where((ALT1 > lim) & (ALT2 > lim))]
        ALT3 = ALT1[np.where((ALT1 > lim) & (ALT2 > lim))]
        AZ4  = AZ2[np.where((ALT1 > lim) & (ALT2 > lim))]
        ALT4 = ALT2[np.where((ALT1 > lim) & (ALT2 > lim))]

        X1, Y1 = plf.polarXY(AZ3, ALT3, lim)
        X2, Y2 = plf.polarXY(AZ4, ALT4, lim)

        for i in range(len(X1)):
            plt.plot([X1[i], X2[i]],[Y1[i], Y2[i]], 'w--', alpha = 0.2)

        if(legend):
            cn = cj.const_namesJ(observe, ax, zo)

if __name__=='__main__':
    import matplotlib.pyplot as plt
    import sky
    from observe import *

    fig, ax = plt.subplots()

    ax.set_aspect('equal')
    sf = sky.skyfield(obs, ax, zo=0, legend=True)
    cl = const_line(obs, ax, zo=1, legend=True)
    ax.axis('off')
    plt.show()
